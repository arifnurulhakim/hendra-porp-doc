<div class="content-section page-break" id="section-09">
<h1>9. API Specifications</h1>

<p><strong>Dokumen API Specifications (For Future Mobile App)</strong>  </p>
<p>Proyek: Hendra Prop - Sistem Manajemen Properti  </p>
<p>Tanggal: 31 Oktober 2025  </p>
<p>Versi: Final</p>
<hr>
<h2>1. API Overview</h2>
<h3>1.1 Base Information</h3>
<ul>
<li><strong>Base URL:</strong> <code>https://api.hendraprop.com/v1</code></li>
<li><strong>Protocol:</strong> HTTPS only</li>
<li><strong>Format:</strong> JSON</li>
<li><strong>Authentication:</strong> Laravel Sanctum (Bearer Token)</li>
<li><strong>Rate Limiting:</strong> 60 requests/minute per user</li>
<li><strong>Versioning:</strong> URL-based (v1, v2, etc.)</li>
</ul>
<h3>1.2 Request Headers</h3>
<pre><code>Content-Type: application/json
Accept: application/json
Authorization: Bearer {token}
X-App-Version: 1.0.0 (optional)
</code></pre>
<h3>1.3 Response Format</h3>
<p><strong>Success Response (2xx):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 1,
    "title": "Rumah Mewah Jakarta Selatan",
    "price": 5000000000
  },
  "meta": {
    "current_page": 1,
    "total": 45
  },
  "message": "Property retrieved successfully"
}
</code></pre>
<p><strong>Error Response (4xx/5xx):</strong></p>
<pre><code>{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "The given data was invalid.",
    "details": {
      "title": ["The title field is required."],
      "price": ["The price must be a number."]
    }
  }
}
</code></pre>
<hr>
<h2>2. Authentication Endpoints</h2>
<h3>2.1 Login</h3>
<pre><code>POST /auth/login
</code></pre>
<p><strong>Request Body:</strong></p>
<pre><code>{
  "email": "agent@hendraprop.com",
  "password": "password123",
  "remember": true
}
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "token": "1|abc123def456ghi789...",
    "user": {
      "id": 5,
      "name": "Agent 1",
      "email": "agent@hendraprop.com",
      "role": "agent",
      "avatar": "https://..."
    }
  },
  "message": "Login successful"
}
</code></pre>
<hr>
<h3>2.2 Logout</h3>
<pre><code>POST /auth/logout
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "message": "Logged out successfully"
}
</code></pre>
<hr>
<h3>2.3 Get Current User</h3>
<pre><code>GET /auth/me
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 5,
    "name": "Agent 1",
    "email": "agent@hendraprop.com",
    "role": "agent",
    "agent": {
      "id": 3,
      "phone": "08123456789",
      "whatsapp": "08123456789",
      "office": {
        "id": 1,
        "name": "Hendra Prop 1"
      }
    }
  }
}
</code></pre>
<hr>
<h2>3. Property Endpoints</h2>
<h3>3.1 List Properties</h3>
<pre><code>GET /properties?page=1&type=house&status=available&price_min=1000000000&price_max=5000000000
</code></pre>
<p><strong>Query Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>page</code></td>
<td>int</td>
<td>Page number (default: 1)</td>
</tr>
<tr>
<td><code>per_page</code></td>
<td>int</td>
<td>Items per page (default: 20, max: 100)</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>Filter by type: house, apartment, land, commercial</td>
</tr>
<tr>
<td><code>listing_type</code></td>
<td>string</td>
<td>Filter: sale, rent, both</td>
</tr>
<tr>
<td><code>status</code></td>
<td>string</td>
<td>Filter: available, pending, sold, rented</td>
</tr>
<tr>
<td><code>price_min</code></td>
<td>decimal</td>
<td>Minimum price</td>
</tr>
<tr>
<td><code>price_max</code></td>
<td>decimal</td>
<td>Maximum price</td>
</tr>
<tr>
<td><code>city</code></td>
<td>string</td>
<td>Filter by city</td>
</tr>
<tr>
<td><code>search</code></td>
<td>string</td>
<td>Search keyword (title, description, address)</td>
</tr>
<tr>
<td><code>sort</code></td>
<td>string</td>
<td>Sort by: price_asc, price_desc, date_desc, views_desc</td>
</tr>
</tbody>
</table>
<pre><code>{
  "success": true,
  "data": [
    {
      "id": 1,
      "slug": "rumah-mewah-jakarta-selatan",
      "title": "Rumah Mewah Jakarta Selatan",
      "type": "house",
      "listing_type": "sale",
      "price": 5000000000,
      "price_per_sqm": 15000000,
      "land_area": 300,
      "building_area": 250,
      "bedrooms": 4,
      "bathrooms": 3,
      "address": "Jl. Kemang Raya No. 10",
      "city": "Jakarta Selatan",
      "status": "available",
      "cover_image": "https://storage.hendraprop.com/properties/1/cover.jpg",
      "views": 152,
      "agent": {
        "id": 3,
        "name": "Agent 1",
        "phone": "08123456789",
        "whatsapp": "08123456789",
        "avatar": "https://..."
      },
      "created_at": "2025-10-15T10:30:00Z"
    }
  ],
  "meta": {
    "current_page": 1,
    "last_page": 5,
    "per_page": 20,
    "total": 95,
    "from": 1,
    "to": 20
  }
}
</code></pre>
<hr>
<h3>3.2 Get Property Detail</h3>
<pre><code>GET /properties/{id}
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 1,
    "slug": "rumah-mewah-jakarta-selatan",
    "title": "Rumah Mewah Jakarta Selatan",
    "description": "Rumah mewah dengan design modern minimalis...",
    "type": "house",
    "listing_type": "sale",
    "price": 5000000000,
    "price_per_sqm": 15000000,
    "land_area": 300,
    "building_area": 250,
    "bedrooms": 4,
    "bathrooms": 3,
    "address": "Jl. Kemang Raya No. 10, Jakarta Selatan",
    "city": "Jakarta Selatan",
    "province": "DKI Jakarta",
    "latitude": -6.259051,
    "longitude": 106.818134,
    "certificate_type": "SHM",
    "status": "available",
    "is_featured": true,
    "views": 152,
    "photos": [
      {
        "id": 1,
        "url": "https://storage.hendraprop.com/properties/1/photo1.jpg",
        "order": 1,
        "is_cover": true
      },
      {
        "id": 2,
        "url": "https://storage.hendraprop.com/properties/1/photo2.jpg",
        "order": 2,
        "is_cover": false
      }
    ],
    "agent": {
      "id": 3,
      "name": "Agent 1",
      "phone": "08123456789",
      "whatsapp": "08123456789",
      "bio": "Experienced property agent...",
      "avatar": "https://..."
    },
    "created_at": "2025-10-15T10:30:00Z",
    "updated_at": "2025-10-20T15:45:00Z"
  }
}
</code></pre>
<hr>
<h3>3.3 Create Property</h3>
<pre><code>POST /properties
</code></pre>
<p><strong>Request Body (multipart/form-data):</strong></p>
<pre><code>{
  "title": "Rumah Mewah Jakarta Selatan",
  "description": "Rumah mewah dengan design modern...",
  "type": "house",
  "listing_type": "sale",
  "price": 5000000000,
  "land_area": 300,
  "building_area": 250,
  "bedrooms": 4,
  "bathrooms": 3,
  "address": "Jl. Kemang Raya No. 10",
  "city": "Jakarta Selatan",
  "province": "DKI Jakarta",
  "latitude": -6.259051,
  "longitude": 106.818134,
  "certificate_type": "SHM",
  "photos": [
    "file1.jpg",
    "file2.jpg"
  ]
}
</code></pre>
<p><strong>Response (201 Created):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 15,
    "slug": "rumah-mewah-jakarta-selatan",
    "title": "Rumah Mewah Jakarta Selatan",
    ...
  },
  "message": "Property created successfully"
}
</code></pre>
<hr>
<h3>3.4 Update Property</h3>
<pre><code>PUT /properties/{id}
</code></pre>
<p><strong>Request Body:</strong> (same as create)</p>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": { ... },
  "message": "Property updated successfully"
}
</code></pre>
<hr>
<h3>3.5 Delete Property</h3>
<pre><code>DELETE /properties/{id}
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "message": "Property deleted successfully"
}
</code></pre>
<hr>
<h2>4. Transaction Endpoints</h2>
<h3>4.1 List Transactions</h3>
<pre><code>GET /transactions?agent_id=3&status=completed&date_from=2025-01-01&date_to=2025-12-31
</code></pre>
<p><strong>Query Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>agent_id</code></td>
<td>int</td>
<td>Filter by agent</td>
</tr>
<tr>
<td><code>office_id</code></td>
<td>int</td>
<td>Filter by office</td>
</tr>
<tr>
<td><code>status</code></td>
<td>string</td>
<td>Filter: pending, completed, cancelled</td>
</tr>
<tr>
<td><code>date_from</code></td>
<td>date</td>
<td>Start date (YYYY-MM-DD)</td>
</tr>
<tr>
<td><code>date_to</code></td>
<td>date</td>
<td>End date (YYYY-MM-DD)</td>
</tr>
</tbody>
</table>
<pre><code>{
  "success": true,
  "data": [
    {
      "id": 10,
      "property": {
        "id": 1,
        "title": "Rumah Mewah Jakarta Selatan",
        "cover_image": "https://..."
      },
      "agent_owner": {
        "id": 3,
        "name": "Agent 1"
      },
      "agent_buyer": {
        "id": 5,
        "name": "Agent 2"
      },
      "buyer_name": "John Doe",
      "buyer_phone": "08123456789",
      "transaction_type": "sale",
      "final_price": 4800000000,
      "commission_percentage": 2,
      "transaction_date": "2025-10-20",
      "status": "completed",
      "created_at": "2025-10-20T16:00:00Z"
    }
  ],
  "meta": {
    "total": 12
  }
}
</code></pre>
<hr>
<h3>4.2 Create Transaction</h3>
<pre><code>POST /transactions
</code></pre>
<p><strong>Request Body:</strong></p>
<pre><code>{
  "property_id": 1,
  "agent_buyer_id": 5,
  "buyer_name": "John Doe",
  "buyer_phone": "08123456789",
  "buyer_email": "john@example.com",
  "transaction_type": "sale",
  "final_price": 4800000000,
  "commission_percentage": 2,
  "transaction_date": "2025-10-20",
  "notes": "Deal after nego"
}
</code></pre>
<p><strong>Response (201 Created):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 15,
    "property_id": 1,
    "final_price": 4800000000,
    "commissions": [
      {
        "type": "agent_owner",
        "agent_id": 3,
        "amount": 33600000,
        "percentage": 35,
        "status": "pending"
      },
      {
        "type": "agent_buyer",
        "agent_id": 5,
        "amount": 33600000,
        "percentage": 35,
        "status": "pending"
      },
      {
        "type": "office",
        "office_id": 1,
        "amount": 28800000,
        "percentage": 30,
        "status": "pending"
      }
    ]
  },
  "message": "Transaction created successfully"
}
</code></pre>
<hr>
<h2>5. Commission Endpoints</h2>
<h3>5.1 List Commissions</h3>
<pre><code>GET /commissions?agent_id=3&status=pending
</code></pre>
<p><strong>Query Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>agent_id</code></td>
<td>int</td>
<td>Filter by agent</td>
</tr>
<tr>
<td><code>office_id</code></td>
<td>int</td>
<td>Filter by office</td>
</tr>
<tr>
<td><code>status</code></td>
<td>string</td>
<td>Filter: pending, paid, cancelled</td>
</tr>
<tr>
<td><code>date_from</code></td>
<td>date</td>
<td>Start date</td>
</tr>
<tr>
<td><code>date_to</code></td>
<td>date</td>
<td>End date</td>
</tr>
</tbody>
</table>
<pre><code>{
  "success": true,
  "data": [
    {
      "id": 25,
      "transaction": {
        "id": 10,
        "property": {
          "title": "Rumah Mewah Jakarta Selatan"
        },
        "transaction_date": "2025-10-20"
      },
      "amount": 33600000,
      "percentage": 35,
      "type": "agent_owner",
      "status": "pending",
      "paid_date": null,
      "created_at": "2025-10-20T16:00:00Z"
    }
  ],
  "meta": {
    "total_pending": 100000000,
    "total_paid": 50000000,
    "total_all": 150000000
  }
}
</code></pre>
<hr>
<h3>5.2 Mark Commission as Paid</h3>
<pre><code>PUT /commissions/{id}/pay
</code></pre>
<p><strong>Request Body:</strong></p>
<pre><code>{
  "paid_date": "2025-10-25",
  "payment_method": "bank_transfer",
  "notes": "Transfer to BCA 1234567890"
}
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "id": 25,
    "status": "paid",
    "paid_date": "2025-10-25",
    "payment_method": "bank_transfer"
  },
  "message": "Commission marked as paid"
}
</code></pre>
<hr>
<h2>6. Dashboard Endpoints</h2>
<h3>6.1 Agent Performance</h3>
<pre><code>GET /dashboard/agent/{agent_id}?date_from=2025-01-01&date_to=2025-12-31
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "agent": {
      "id": 3,
      "name": "Agent 1"
    },
    "metrics": {
      "total_listings": 25,
      "total_listings_sold": 10,
      "total_transactions": 12,
      "total_omzet": 50000000000,
      "total_commission": 1200000000,
      "commission_pending": 500000000,
      "commission_paid": 700000000
    },
    "omzet_per_month": [
      { "month": "2025-01", "omzet": 5000000000 },
      { "month": "2025-02", "omzet": 8000000000 }
    ]
  }
}
</code></pre>
<hr>
<h3>6.2 Office Performance</h3>
<pre><code>GET /dashboard/office/{office_id}?date_from=2025-01-01&date_to=2025-12-31
</code></pre>
<p><strong>Response (200 OK):</strong></p>
<pre><code>{
  "success": true,
  "data": {
    "office": {
      "id": 1,
      "name": "Hendra Prop 1"
    },
    "metrics": {
      "total_agents": 15,
      "total_listings": 120,
      "total_transactions": 45,
      "total_omzet": 150000000000,
      "office_commission": 2000000000
    },
    "agents_performance": [
      {
        "agent_id": 3,
        "name": "Agent 1",
        "total_listings": 25,
        "total_omzet": 50000000000,
        "total_commission": 1200000000
      }
    ]
  }
}
</code></pre>
<hr>
<h2>7. Error Codes</h2>
<table>
<thead>
<tr>
<th>Code</th>
<th>HTTP Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VALIDATION_ERROR</code></td>
<td>422</td>
<td>Input validation failed</td>
</tr>
<tr>
<td><code>UNAUTHORIZED</code></td>
<td>401</td>
<td>Not authenticated</td>
</tr>
<tr>
<td><code>FORBIDDEN</code></td>
<td>403</td>
<td>No permission to access resource</td>
</tr>
<tr>
<td><code>NOT_FOUND</code></td>
<td>404</td>
<td>Resource not found</td>
</tr>
<tr>
<td><code>SERVER_ERROR</code></td>
<td>500</td>
<td>Internal server error</td>
</tr>
<tr>
<td><code>RATE_LIMIT_EXCEEDED</code></td>
<td>429</td>
<td>Too many requests</td>
</tr>
</tbody>
</table>
<h2>8. Rate Limiting</h2>
<ul>
<li><strong>Default:</strong> 60 requests/minute per user</li>
<li><strong>Authenticated:</strong> 120 requests/minute</li>
<li><strong>Public endpoints:</strong> 30 requests/minute per IP</li>
</ul>
<p><strong>Response when rate limit exceeded:</strong></p>
<pre><code>{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests. Please try again in 60 seconds.",
    "retry_after": 60
  }
}
</code></pre>
<hr>
<p><strong>Prepared by:</strong> AI Project Analysis System  </p>
<p><strong>Date:</strong> 31 Oktober 2025  </p>
<p><strong>Version:</strong> 1.0.0</p>
    </div>